# Secret-Links: Сервис временных секретных ссылок для просмотра оставленного сообщения

## Описание работы:
- Получает секретные данные (текст) через POST-запрос
- Сохраняет данные временно в памяти
- Генерирует уникальный короткий URL и возвращает его
- Возвращает секрет при переходе по URL с ограничениями (время жизни, макс. кол. просмотров)
- Отправляет данные о событиях чеерез Kafka
- Удаляет ссылку при срабатывании ограничений
- Собирает статистику посещений каждой ссылки

## Особенности проекта
- Генерация уникальных коротких URL
- Ограничение по времени жизни и просмотрам
- Автоматическое удаление ссылок
- Логирование всех запросов
- Использование промежуточного слоя (middleware)
- Использование брокера сообщений Kafka для передачи статистических событий

## Прекращение действия ссылки:
- Истечение времени (по умолчанию 1 час)
- Превышение лимита просмотров (по умолчанию 1 раз)

## Работа

1. **Запуск**:
```bash
docker-compose up -d
```
```bash
go run main.go
```
```bash
go run stats/main.go
```
2. **POST запрос на localhost:8080/create**
```bash
curl -X POST -d "secret=СЕКРЕТНАЯИНФОРМАЦИЯ&expiration=30&maxviews=5" http://localhost:8080/create
```
**secret=ВАШСЕКРЕТ** *- то, что Вы хотите передать*

**expiration=30** *- время доступности просмотра в минутах*

**maxviews=5** *- количество просмотров*

3. **Ответ**:
```bash
http://localhost:8080/AbCdEfGh
```
```bash
Stats module activated
ID: AbCdEfGh | Created: 2025-07-15 12:22:12 | Visits: 0 
```
4. **Получение информации**:
```bash
curl http://localhost:8080/AbCdEfGh
```
5. **Получение итоговой статистики**:

*При завершении сбора статистики*
```bash
Final statistics:
Stats Storage:
ID: AbCdEfGh | Created: 2025-07-15 12:22:12 | Visits: 0 
ID: KlMnOpqR | Created: 2025-07-15 14:22:14 | Visits: 1, last visit: 2025-07-15 18:00:18
ID: StXyZaBc | Created: 2025-07-15 16:22:16 | Visits: 0 
ID: DeFgHkLm | Created: 2025-07-15 20:22:18 | Visits: 2, last visit: 2025-07-15 22:22:22
```
## Структура проекта
```bash
secretlinks
        ├── handlers          # HTTP-обработчики
        │   ├── create.go     # Создание короткой ссылки
        │   ├── kafka.go      # Отпавка данных в отдел статистики
        │   └── redirect.go   # Переход по короткой ссылке
        ├── stats             # Сбор статистики
        │   └── main.go       # Точка входа статистики, прием данных
        ├── storage           # Логика хранения данных
        ├── middleware        # Промежуточный слой
        ├── main.go           # Точка входа
        ├── go.sum
        └── go.mod
```
 
